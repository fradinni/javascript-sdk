import { CsrSubjectJson } from './__json__/csr-subject-json';
import { Attribute } from './attribute';

/* istanbul ignore next: autogenerated */
export class CsrSubject {

  constructor(private _json: CsrSubjectJson) {
  }

  /**
   * Get subject common name.
   * @returns {string}
   */
  get cn(): string {
    return this._json.cn;
  }

  /**
   * Get subject organization unit.
   * @returns {string}
   */
  get ou(): string {
    return this._json.ou;
  }

  /**
   * Get subject organization.
   * @returns {string}
   */
  get o(): string {
    return this._json.o;
  }

  /**
   * Get subject locality.
   * @returns {string}
   */
  get l(): string {
    return this._json.l;
  }

  /**
   * Get subject state or province.
   * @returns {string}
   */
  get st(): string {
    return this._json.st;
  }

  /**
   * Get subject country.
   * @returns {string}
   */
  get c(): string {
    return this._json.c;
  }

  /**
   * Convert to an Array of Attributes.
   * @returns {Array<Attribute>}
   */
  toAttributeArray(): Array<Attribute> {
    return [
      new Attribute({ key: 'CN', value: this._json.cn }),
      new Attribute({ key: 'OU', value: this._json.ou }),
      new Attribute({ key: 'O', value: this._json.o }),
      new Attribute({ key: 'L', value: this._json.l }),
      new Attribute({ key: 'ST', value: this._json.st }),
      new Attribute({ key: 'C', value: this._json.c })
    ];
  }

  /**
   * Get the json representation of this class.
   * @returns {CsrSubjectJson}
   */
  get json(): CsrSubjectJson {
    return Object.assign({}, this._json);
  }

  /**
   * Get the string representation of this class.
   * @returns {string}
   */
  toString(): string {
    return JSON.stringify(this._json, undefined, 2);
  }
}
